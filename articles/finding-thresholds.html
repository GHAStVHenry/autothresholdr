<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finding Thresholds • autothresholdr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Finding Thresholds">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autothresholdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/finding-thresholds.html">Finding Thresholds</a>
    </li>
    <li>
      <a href="../articles/thresholding-image-stacks.html">Thresholding Image Stacks</a>
    </li>
    <li>
      <a href="../articles/thresholding-images.html">Thresholding Images</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Finding Thresholds</h1>
            
            <h4 class="date">2019-05-20</h4>
      
      
      <div class="hidden name"><code>finding-thresholds.Rmd</code></div>

    </div>

    
    
<p>Most of the examples from this package are centred around thresholding images, but really the core function <code><a href="../reference/auto_thresh.html">auto_thresh()</a></code> can be used to find thresholds for any non-negative integer data.</p>
<div id="mostly-high-some-low" class="section level2">
<h2 class="hasAnchor">
<a href="#mostly-high-some-low" class="anchor"></a>Mostly high, some low</h2>
<p>Let’s create a vector of values, most of which are greater than 50, the rest of which are less than 10:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample.int</a></span>(<span class="dv">9</span>, <span class="fl">2e5</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">51</span><span class="op">:</span><span class="dv">99</span>, <span class="fl">8e5</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<p>Now let’s take a look at the distribution of <code>x</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="dt">x =</span> x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(x) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_density">stat_density</a></span>(<span class="dt">bw =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="finding-thresholds_files/figure-html/plot-high-low-1.png" width="672"></p>
<p>If you’re trying to threshold this sort of data, you’re probably looking for a method which will find a threshold that separates the larger values from the smaller ones. The available automatic thresholding methods are “IJDefault”, “Huang”, “Huang2”, “Intermodes”, “IsoData”, “Li”, “MaxEntropy”, “Mean”, “MinErrorI”, “Minimum”, “Moments”, “Otsu”, “Percentile”, “RenyiEntropy”, “Shanbhag”, “Triangle” and “Yen”. These are well demonstrated at <a href="http://imagej.net/Auto_Threshold" class="uri">http://imagej.net/Auto_Threshold</a>.</p>
</div>
<div id="trying-all-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#trying-all-methods" class="anchor"></a>Trying all methods</h2>
<p>“MaxEntropy” and “Yen” often fail to find a threshold, so I generally avoid them. Let’s try out all the rest.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(autothresholdr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">thresh_methods &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"IJDefault"</span>, <span class="st">"Huang"</span>, <span class="st">"Huang2"</span>, <span class="st">"Intermodes"</span>, <span class="st">"IsoData"</span>, </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                    <span class="st">"Li"</span>, <span class="st">"Mean"</span>, <span class="st">"MinErrorI"</span>, <span class="st">"Minimum"</span>, <span class="st">"Moments"</span>, <span class="st">"Otsu"</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                    <span class="st">"Percentile"</span>, <span class="st">"RenyiEntropy"</span>, <span class="st">"Shanbhag"</span>, <span class="st">"Triangle"</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">thresholds &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span>(thresh_methods, <span class="op">~</span><span class="kw"><a href="../reference/auto_thresh.html">auto_thresh</a></span>(x, .)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="dt">method =</span> thresh_methods, <span class="dt">threshold =</span> .)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(thresholds)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; # A tibble: 15 x 2</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;    method       threshold</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;  1 IJDefault    39       </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  2 Huang        8        </span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  3 Huang2       8        </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  4 Intermodes   38       </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;  5 IsoData      39       </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;  6 Li           24       </span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  7 Mean         59       </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;  8 MinErrorI    59       </span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;  9 Minimum      32       </span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; 10 Moments      55       </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; 11 Otsu         8        </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; 12 Percentile   67       </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; 13 RenyiEntropy 69       </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; 14 Shanbhag     69       </span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; 15 Triangle     10</span></a></code></pre></div>
<p>Now, which of these selected a threshold between 10 and 49?</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(thresholds, threshold <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>, threshold <span class="op">&lt;=</span><span class="st"> </span><span class="dv">49</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;   method     threshold</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 1 IJDefault  39       </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 2 Intermodes 38       </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 3 IsoData    39       </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 4 Li         24       </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 5 Minimum    32       </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 6 Triangle   10</span></a></code></pre></div>
<p>The other methods aren’t necessarily <em>wrong</em>, they’re just more strict or more lax than these ones. For thresholding microscopy images to remove background, my favourite methods are “Huang” and “Triangle” because they are quite conservative in that anything even slightly above background is kept.</p>
</div>
<div id="using-one-method" class="section level2">
<h2 class="hasAnchor">
<a href="#using-one-method" class="anchor"></a>Using one method</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/auto_thresh.html">auto_thresh</a></span>(x, <span class="st">"huang"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; attr(,"ignore_black")</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; attr(,"ignore_white")</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; attr(,"ignore_na")</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; attr(,"autothresh_method")</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; [1] "Huang"</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; [1] "th"      "integer"</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw"><a href="../reference/auto_thresh.html">auto_thresh</a></span>(x, <span class="st">"tri"</span>)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; attr(,"ignore_black")</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; attr(,"ignore_white")</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; attr(,"ignore_na")</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; attr(,"autothresh_method")</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; [1] "Triangle"</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; [1] "th"      "integer"</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="kw"><a href="../reference/auto_thresh.html">auto_thresh</a></span>(x,  <span class="st">"otsu"</span>)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; attr(,"ignore_black")</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt; attr(,"ignore_white")</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt; attr(,"ignore_na")</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#&gt; attr(,"autothresh_method")</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">#&gt; [1] "Otsu"</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="co">#&gt; [1] "th"      "integer"</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#mostly-high-some-low">Mostly high, some low</a></li>
      <li><a href="#trying-all-methods">Trying all methods</a></li>
      <li><a href="#using-one-method">Using one method</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rory Nolan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
